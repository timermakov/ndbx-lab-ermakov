# Правила внесения изменений в репозиторий

Этот репозиторий создан из шаблона для выполнения лабораторных работ.
Пожалуйста, придерживайтесь следующих правил для корректной работы автоматических проверок.

## Структура проекта

Вы выполняете лабораторные работы в корне репозитория.
Все необходимые файлы для запуска проекта в рамках **всех** лабораторных работ
должны находиться в корневой директории.

### Шпаргалка по допустимым изменениям

```sh
.
├── .github/  # ❌ НЕ ТРОГАТЬ! Конфигурация Github Actions
├── api/  # Опционально. Коллекции запросов для тестирования API
├── CODEOWNERS  # ❌ НЕ ТРОГАТЬ! Конфигурация ревьюеров
├── .labrc  # Обязателен. Изменяйте номер текущей лабораторной работы
├── .env.local  # Обязателен. Настройки окружения для Docker и приложения
├── docker-compose.yml  # Обязателен. Создайте сами и опишите все необходимые сервисы.
├── Makefile  # Обязателен. Команды для запуска проекта
├── README.md  # Опционально. Документация проекта
└── ...  # Остальные файлы - ваш код. Допустимы любые изменения.
```

### Примеры структуры проекта

#### Golang-проекты

```sh
.
├── cmd/
│   ├── app/
│   │   └── main.go # Точка входа приложения
│   └── internal/
│       └── ...  # Внутренняя логика приложения
├── Makefile
├── docker-compose.yml
├── .env.local
├── .labrc
└── ...
```

#### Java-проекты

```sh
.
├── src/main/
│   └── java/
│       └── ...  # Ваш Java-код
├── Makefile
├── docker-compose.yml
├── .env.local
├── .labrc
└── ...
```

#### Python-проекты

```sh
.
├── app/
│   └── ...  # Ваш Python-код
├── Makefile
├── docker-compose.yml
├── .env.local
├── .labrc
└── ...
```

#### PHP-проекты

```sh
.
├── public/
│   └── index.php  # Точка входа приложения
├── src/
│   └── ...  # Внутренняя логика приложения
├── Makefile
├── docker-compose.yml
├── .env.local
├── .labrc
└── ...
```

## Запуск проекта

### Docker

Проект должен запускаться в Docker'е с помощью Docker Compose.

> ⚠️ Файл `docker-compose.yml` создайте самостоятельно

В файле `docker-compose.yml` должны быть описаны все необходимые сервисы для запуска вашего приложения.

### Конфигурация

> ⚠️ `.env.local` - единственный файл конфигурации для вашего проекта

Ваш проект должен брать всю конфигурацию из файла `.env.local`:

- Как Docker, так и ваше приложение должны использовать переменные окружения из этого файла
- Не допускайте хардкода конфигурации в `docker-compose.yml` или `Dockerfile`
- Не допускайте дублирования конфигурации в других файлах, например, в `config.yaml` и т.д.

### Makefile

В корне репозитория должен находиться `Makefile`, как минимум, со следующими командами:

```makefile
.PHONY: run
run:
    docker compose --env-file .env.local up -d --build

.PHONY: stop
stop:
    docker compose --env-file .env.local down
```

> Можете использовать шаблон из корня проекта

## Документация

> Не забывайте документировать ваш проект в `README.md` в корне репозитория.

Документируйте:

- Как запустить проект
- Как использовать проект
- Любую другую полезную информацию

### API

Предоставляйте коллекцию Postman или аналогичный инструмент
с шаблонами запросов и ответов для тестирования вашего API.

Допускается использовать [Postman](https://www.postman.com/),
[Insomnia](https://insomnia.rest/) или
[Swagger](https://swagger.io/).

Колекцию разместите в директории `api/` в корне репозитория.

## Автоматическая проверка

Все лабораторные работы проверяются автоматически с помощью GitHub Actions.
После создания Pull Request'а, GitHub Actions запустит пайплайн для проверки вашего решения.

> ⚠️ **Не изменяйте файлы в `.github/` директории!** Это может сломать автоматические проверки.

### Запуск проверки

При выполнении очередной лабораторной работы **измените номер** в `.labrc` на тот,
который соответствует текущей работе и закоммитьте это изменение вместе с вашим решением.

Пример содержимого файла `.labrc` для лабораторной работы №2:

```sh
# Номер лабораторной работы, которую проверяем в CI.
LAB=2
```

Пайплайн GitHub Actions прочитает этот файл
и запустит соответствующие проверки для вашей лабораторной работы.

## Pull Requests

После выполнения лабораторной работы, создайте Pull Request в **свой** репозиторий:

- Base: `ваш-username/ndbx:main`
- Compare: `ваш-username/ndbx:feature/lab-1`

### Github Actions

GitHub Actions автоматически запустит проверку лабораторной работы.
Смотрите результат во вкладке Actions в pull request'е или в вашем репозитории.

>⚠️ Пайплайн должен быть "зелёным" (все проверки пройдены успешно).

### Код-ревью

После создания Pull Request'а, ревьюер назначится автоматически и проведёт код-ревью вашего решения.
Если ревьюер не назначился автоматически, убедитесь, что у вас есть коллаборации с преподавателем в вашем репозитории.
Если у вас возникли сложности, обратитесь к преподавателю [@sitnikovik](https://t.me/sitnikovik) за помощью.

При наличии замечаний, внесите правки и запушьте их в ту же ветку.
Пайплайн запустится автоматически после каждого пуша.

### Принятие PR

После успешного прохождения всех проверок в пайплайне и одобрения ревьюером,
вы сможете смержить Pull Request в main-ветку своего репозитория.

## Рекомендации

Придерживайтесь рекомендаций при выполнении лабораторных работ, описанных в
[документации курса](https://github.com/sitnikovik/ndbx?tab=readme-ov-file#%D1%80%D0%B5%D0%BA%D0%BE%D0%BC%D0%B5%D0%BD%D0%B4%D0%B0%D1%86%D0%B8%D0%B8).
